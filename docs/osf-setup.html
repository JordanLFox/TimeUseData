<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSF Backend Setup - O-ELIDDI Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
            background-color: #fafafa;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }
        .nav-back {
            margin-bottom: 1rem;
        }
        .nav-back a {
            color: #667eea;
            text-decoration: none;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            display: inline-block;
        }
        .section {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        .section h2 {
            color: #667eea;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 0.5rem;
        }
        code {
            background: #f1f3f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
        }
        pre {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid #e9ecef;
        }
        pre code {
            background: none;
            padding: 0;
        }
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .step-box {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #667eea;
        }
        .step-number {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 1rem;
        }
        .url-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 5px;
            font-family: monospace;
            word-break: break-all;
            margin: 1rem 0;
        }
        .checklist {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .checklist ul {
            list-style: none;
            padding: 0;
        }
        .checklist li {
            padding: 0.25rem 0;
        }
        .checklist li:before {
            content: "☐ ";
            font-weight: bold;
            color: #667eea;
        }
        .benefit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .benefit-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 1rem;
        }
        .benefit-card h4 {
            margin-top: 0;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="nav-back">
        <a href="index.html">← Back to Documentation Home</a>
    </div>

    <div class="header">
        <h1>OSF Backend Setup</h1>
        <p>Setting up data collection with JSPsych DataPipe and Open Science Framework</p>
    </div>

    <div class="section">
        <h2>Overview</h2>
        <p>The Open Science Framework (OSF) provides a robust, free platform for research data management. Combined with JSPsych DataPipe, it offers secure, automated data collection for O-ELIDDI studies with built-in research best practices.</p>
        
        <div class="benefit-grid">
            <div class="benefit-card">
                <h4>Free & Open</h4>
                <p>Completely free for academic research with unlimited storage and no participant limits.</p>
            </div>
            <div class="benefit-card">
                <h4>Secure</h4>
                <p>Data encrypted in transit and at rest, with granular access controls and audit trails.</p>
            </div>
            <div class="benefit-card">
                <h4>Research-Ready</h4>
                <p>Built-in version control, metadata management, and collaboration tools for research teams.</p>
            </div>
            <div class="benefit-card">
                <h4>Automatic</h4>
                <p>No server setup required - data flows automatically from your study to OSF storage.</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>Prerequisites</h2>
        <div class="checklist">
            <strong>Before you begin, ensure you have:</strong>
            <ul>
                <li>An OSF account (free at osf.io)</li>
                <li>A deployed O-ELIDDI study (see GitHub Pages Deployment guide)</li>
                <li>Basic understanding of your study's data collection needs</li>
                <li>Institutional ethics approval (if required)</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>Step-by-Step Setup</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Create OSF Account</h3>
            <p>If you don't already have an OSF account:</p>
            <ol>
                <li>Visit <a href="https://osf.io" target="_blank">osf.io</a></li>
                <li>Click <strong>"Sign Up"</strong></li>
                <li>Use your institutional email address if available</li>
                <li>Verify your email address</li>
                <li>Complete your profile with research information</li>
            </ol>
            <div class="info">
                <strong>Tip:</strong> Using an institutional email helps establish credibility and may provide access to additional OSF features.
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Create a New OSF Project</h3>
            <p>Set up a project to organize your study data:</p>
            <ol>
                <li>Log into OSF and click <strong>"Create new project"</strong></li>
                <li>Enter a descriptive project title (e.g., "Daily Activity Patterns Study 2024")</li>
                <li>Add a project description including:
                    <ul>
                        <li>Study objectives and research questions</li>
                        <li>Participant demographics and recruitment</li>
                        <li>Data collection timeline</li>
                        <li>Analysis plan overview</li>
                    </ul>
                </li>
                <li>Set appropriate access permissions:
                    <ul>
                        <li><strong>Public:</strong> For open science projects</li>
                        <li><strong>Private:</strong> For sensitive data (can be made public later)</li>
                    </ul>
                </li>
                <li>Add relevant tags and subjects for discoverability</li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Access JSPsych DataPipe</h3>
            <p>Set up automated data collection through DataPipe:</p>
            <ol>
                <li>Visit <a href="https://pipe.jspsych.org" target="_blank">pipe.jspsych.org</a></li>
                <li>Click <strong>"Get Started"</strong></li>
                <li>Sign in with your OSF credentials</li>
                <li>Authorize DataPipe to access your OSF account</li>
            </ol>
            <div class="warning">
                <strong>Authorization:</strong> DataPipe needs access to create files in your OSF projects. This is secure and only allows DataPipe to upload data files to projects you specify.
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">4</span>Create DataPipe Experiment</h3>
            <p>Configure DataPipe for your O-ELIDDI study:</p>
            <ol>
                <li>In DataPipe dashboard, click <strong>"Create Experiment"</strong></li>
                <li>Enter experiment details:
                    <ul>
                        <li><strong>Name:</strong> Match your OSF project name</li>
                        <li><strong>Description:</strong> Brief description of data being collected</li>
                        <li><strong>OSF Project:</strong> Select the project you created in Step 2</li>
                    </ul>
                </li>
                <li>Configure data settings:
                    <ul>
                        <li><strong>Data format:</strong> CSV (default, recommended for O-ELIDDI)</li>
                        <li><strong>File naming:</strong> Use default pattern</li>
                        <li><strong>Storage location:</strong> Confirm correct OSF project</li>
                    </ul>
                </li>
                <li>Click <strong>"Create Experiment"</strong></li>
                <li><strong>Important:</strong> Copy the generated <strong>Experiment ID</strong> - you'll need this for O-ELIDDI configuration</li>
            </ol>
            
            <div class="highlight">
                <strong>Experiment ID Example:</strong> Your ID will look something like <code>eR8ENvJPgQth</code> - save this securely as it's required for data collection.
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">5</span>Configure O-ELIDDI</h3>
            <p>Connect your study to DataPipe by updating the configuration:</p>
            <ol>
                <li>Open your O-ELIDDI repository (locally or on GitHub)</li>
                <li>Edit <code>settings/activities.json</code></li>
                <li>Update the <code>experimentID</code> field in the <code>general</code> section:</li>
            </ol>
            <pre><code>{
  "general": {
    "experimentID": "YOUR_DATAPIPE_EXPERIMENT_ID",
    "app_name": "Your Study Name",
    "version": "1.0.0",
    "author": "Your Name",
    "language": "en",
    "instructions": true,
    "primary_redirect_url": "pages/thank-you.html",
    "fallbackToCSV": true
  },
  // ... rest of configuration
}</code></pre>
            <div class="warning">
                <strong>Important:</strong> Replace <code>YOUR_DATAPIPE_EXPERIMENT_ID</code> with the actual ID from Step 4. Keep <code>fallbackToCSV: true</code> for backup data collection.
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">6</span>Test Data Collection</h3>
            <p>Verify that data flows correctly from your study to OSF:</p>
            <ol>
                <li>Deploy your updated O-ELIDDI configuration</li>
                <li>Complete a test timeline on your deployed study</li>
                <li>Submit the data and note any error messages</li>
                <li>Check your OSF project for the uploaded data file</li>
                <li>Download and examine the CSV to verify data format</li>
            </ol>
            
            <div class="success">
                <strong>Successful Test Indicators:</strong>
                <ul>
                    <li>No error messages during data submission</li>
                    <li>Automatic redirect to thank you page</li>
                    <li>CSV file appears in OSF project within minutes</li>
                    <li>File contains expected timeline data and metadata</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>Data Management on OSF</h2>

        <h3>File Organization</h3>
        <p>DataPipe automatically organizes your files in the OSF project:</p>
        <ul>
            <li><strong>Folder structure:</strong> Files are typically stored in the main project directory</li>
            <li><strong>File naming:</strong> <code>timeline_{participantID}_{timestamp}.csv</code></li>
            <li><strong>Automatic versioning:</strong> OSF tracks all file changes and versions</li>
        </ul>

        <h3>Accessing Your Data</h3>
        <div class="step-box">
            <h4>Via OSF Web Interface</h4>
            <ol>
                <li>Log into OSF and navigate to your project</li>
                <li>Click <strong>"Files"</strong> tab</li>
                <li>Browse and download individual files or entire folders</li>
                <li>Use built-in preview for CSV files</li>
            </ol>
        </div>

        <div class="step-box">
            <h4>Via API Access</h4>
            <p>For automated data processing, use OSF's API:</p>
            <pre><code># Python example using requests
import requests

# Get project files
project_id = "YOUR_OSF_PROJECT_ID"
url = f"https://api.osf.io/v2/nodes/{project_id}/files/osfstorage/"
response = requests.get(url)

# Download specific file
file_download_url = "DIRECT_FILE_URL_FROM_API"
data = requests.get(file_download_url).content</code></pre>
        </div>

        <h3>Data Backup and Security</h3>
        <ul>
            <li><strong>Automatic backups:</strong> OSF maintains multiple copies of your data</li>
            <li><strong>Version history:</strong> All file versions are preserved</li>
            <li><strong>Access logs:</strong> Track who accessed what data when</li>
            <li><strong>Export options:</strong> Download entire projects as ZIP files</li>
        </ul>
    </div>

    <div class="section">
        <h2>Privacy and Ethics Configuration</h2>

        <h3>Project Visibility Settings</h3>
        <div class="info">
            <strong>Visibility Options:</strong>
            <ul>
                <li><strong>Private:</strong> Only you and collaborators can access (recommended for active data collection)</li>
                <li><strong>Public:</strong> Visible to everyone (consider for post-publication data sharing)</li>
                <li><strong>Embargoed:</strong> Public metadata, private data until a specified date</li>
            </ul>
        </div>

        <h3>Ethical Considerations</h3>
        <div class="checklist">
            <strong>Before collecting data, ensure:</strong>
            <ul>
                <li>Institutional ethics approval is obtained</li>
                <li>Participant consent procedures are documented</li>
                <li>Data anonymization protocols are in place</li>
                <li>Data retention policies are established</li>
                <li>Access permissions are properly configured</li>
                <li>Compliance with relevant regulations (GDPR, HIPAA, etc.)</li>
            </ul>
        </div>

        <h3>Data Anonymization</h3>
        <p>O-ELIDDI can collect anonymous data by design:</p>
        <ul>
            <li><strong>No personal information:</strong> Timeline data contains no inherently identifying information</li>
            <li><strong>Participant IDs:</strong> Use anonymous codes rather than names or email addresses</li>
            <li><strong>URL parameters:</strong> Avoid including sensitive information in participant links</li>
            <li><strong>IP addresses:</strong> Not collected by O-ELIDDI or stored in timeline data</li>
        </ul>
    </div>

    <div class="section">
        <h2>Collaboration and Team Management</h2>

        <h3>Adding Team Members</h3>
        <ol>
            <li>In your OSF project, click <strong>"Contributors"</strong></li>
            <li>Click <strong>"Add"</strong> and enter collaborator email addresses</li>
            <li>Set appropriate permission levels:
                <ul>
                    <li><strong>Administrator:</strong> Full project control</li>
                    <li><strong>Read + Write:</strong> Can view and upload data</li>
                    <li><strong>Read:</strong> View-only access</li>
                </ul>
            </li>
            <li>Send invitations and manage access as needed</li>
        </ol>

        <h3>DataPipe Access Management</h3>
        <div class="warning">
            <strong>DataPipe Security:</strong> Only the OSF account holder who created the DataPipe experiment can modify its settings. Team members access data through OSF project permissions, not DataPipe directly.
        </div>
    </div>

    <div class="section">
        <h2>Monitoring and Troubleshooting</h2>

        <h3>DataPipe Dashboard</h3>
        <p>Monitor your data collection through the DataPipe interface:</p>
        <ul>
            <li><strong>Upload statistics:</strong> Number of successful uploads</li>
            <li><strong>Error logs:</strong> Details of any failed uploads</li>
            <li><strong>Recent activity:</strong> Timeline of data submissions</li>
            <li><strong>Storage usage:</strong> Amount of data collected</li>
        </ul>

        <h3>Common Issues and Solutions</h3>
        
        <div class="warning">
            <strong>Data Not Appearing in OSF:</strong>
            <ul>
                <li>Check experimentID is correct in activities.json</li>
                <li>Verify OSF project permissions</li>
                <li>Look for error messages in browser console</li>
                <li>Check DataPipe dashboard for upload errors</li>
                <li>Wait up to 5 minutes for processing delays</li>
            </ul>
        </div>

        <div class="warning">
            <strong>Authentication Errors:</strong>
            <ul>
                <li>Reauthorize DataPipe in your OSF account settings</li>
                <li>Check that the OSF project still exists</li>
                <li>Verify you have write permissions to the project</li>
                <li>Try creating a test experiment with a new project</li>
            </ul>
        </div>

        <h3>Debugging Data Collection</h3>
        <div class="step-box">
            <h4>Browser Console Testing</h4>
            <p>Test DataPipe connectivity directly in browser console:</p>
            <pre><code>// Check if data would be sent successfully
console.log(window.timelineManager.study);

// Test DataPipe endpoint (replace with your experiment ID)
fetch('https://pipe.jspsych.org/api/data/', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
        experimentID: 'YOUR_EXPERIMENT_ID',
        filename: 'test.csv',
        data: 'test,data\n1,2'
    })
}).then(response => console.log(response));</code></pre>
        </div>
    </div>

    <div class="section">
        <h2>Data Analysis Preparation</h2>

        <h3>Batch Data Download</h3>
        <p>For analysis, download all participant data at once:</p>
        <ol>
            <li>In OSF project, go to <strong>Files</strong> tab</li>
            <li>Select all data files (Ctrl+click or Shift+click)</li>
            <li>Click <strong>Download</strong> to get a ZIP file</li>
            <li>Extract CSV files for analysis</li>
        </ol>

        <h3>Data Aggregation Scripts</h3>
        <div class="step-box">
            <h4>Python Example</h4>
            <pre><code>import pandas as pd
import glob
import os

# Read all CSV files from download
csv_files = glob.glob("downloaded_data/*.csv")
all_data = []

for file in csv_files:
    df = pd.read_csv(file)
    all_data.append(df)

# Combine all participant data
combined_data = pd.concat(all_data, ignore_index=True)

# Save master dataset
combined_data.to_csv("master_timeline_data.csv", index=False)</code></pre>
        </div>

        <h3>Quality Control Checks</h3>
        <div class="checklist">
            <strong>Recommended data quality checks:</strong>
            <ul>
                <li>Verify all expected participants have submitted data</li>
                <li>Check for duplicate submissions</li>
                <li>Validate timeline coverage completeness</li>
                <li>Review timestamp formatting and ranges</li>
                <li>Identify any unusual activity patterns</li>
                <li>Check URL parameter data for accuracy</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>Advanced Features</h2>

        <h3>OSF Registrations</h3>
        <p>For enhanced research credibility, consider creating an OSF registration:</p>
        <ul>
            <li><strong>Preregistration:</strong> Document study plan before data collection</li>
            <li><strong>Timestamps:</strong> Immutable record of research decisions</li>
            <li><strong>Templates:</strong> Structured formats for different study types</li>
            <li><strong>DOI assignment:</strong> Permanent identifiers for citations</li>
        </ul>

        <h3>Integration with Other Tools</h3>
        <div class="benefit-grid">
            <div class="benefit-card">
                <h4>GitHub Integration</h4>
                <p>Link your OSF project to your GitHub repository for complete reproducibility.</p>
            </div>
            <div class="benefit-card">
                <h4>ORCID Integration</h4>
                <p>Connect your ORCID profile for automatic publication tracking.</p>
            </div>
            <div class="benefit-card">
                <h4>Institutional Storage</h4>
                <p>Add institutional storage accounts for additional backup.</p>
            </div>
            <div class="benefit-card">
                <h4>Reference Managers</h4>
                <p>Export citations directly to Zotero, Mendeley, and other tools.</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>Best Practices Summary</h2>
        
        <div class="success">
            <strong>For successful OSF + DataPipe deployment:</strong>
            <ul>
                <li><strong>Test thoroughly:</strong> Always verify data flow before launching</li>
                <li><strong>Document everything:</strong> Use OSF project descriptions and wiki features</li>
                <li><strong>Plan for scale:</strong> Consider data volume and analysis requirements</li>
                <li><strong>Backup strategy:</strong> Enable CSV fallback and monitor regularly</li>
                <li><strong>Team coordination:</strong> Set clear access permissions and roles</li>
                <li><strong>Ethical compliance:</strong> Ensure all necessary approvals before data collection</li>
            </ul>
        </div>

        <div class="highlight">
            <strong>Remember:</strong> OSF and DataPipe provide powerful infrastructure for research data management. Take advantage of the built-in features for version control, collaboration, and reproducibility to enhance your study's impact and credibility.
        </div>
    </div>
</body>
</html>